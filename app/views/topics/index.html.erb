<div class="container topic-group">

  <div class="row">
    <p>
      <%= link_to "New Topic", new_topic_path, :class => "btn btn-primary" %>
      <%= link_to "排序：最後回覆時間", topics_path( :order => "last_time"), :class => "btn btn-success" %>
      <%= link_to "排序：回復數量", topics_path( :order => "num_of_comments"), :class => "btn btn-success" %>
      <%= link_to "排序：標題", topics_path( :order => "capital"), :class => "btn btn-success" %>
    </p>
    
    <table class="table table-hover">
        <tr class="info">
          <th>
            Num
          </th>
          <th>
            Topic Name
          </th>
          <th>
            Function
          </th>
          <th>
            Created Date
          </th>
        </tr>
      <% @topics.each do |topic| %>
        <tr>
          <td>
            <%= Comment.count_by_topic_id(topic.id).to_s + " comments"  %>
          </td>
          <td>
            <%= link_to topic.name, topic_path(topic), :class => "btn btn-default" %>
          </td>
          <td>
            <%= link_to "Delete", topic_path(topic), :method => "delete", :class => "btn btn-default" %>
            <% if current_user %>
              <% unless current_user.had_liked_topic?( topic ) %>
                <%= link_to "Like", topic_liked_index_path( topic ), :method => "post" , :class => "btn btn-primary" %>
              <% else %>

                <%# 待修正 %>

                <%= link_to "Dislike", topic_liked_path( topic, LikeTopic.where( :user_id => current_user.id, :topic_id => topic.id ).first ), :method => "delete" , :class => "btn btn-primary" %>

                <%# 待修正 %>

              <% end %>
            <% end %>
          </td>
          <td>
            <%= topic.created_at.to_s.split[0]  %>
          </td>
        </tr>
      <% end %>
    </table>

  </div>


</div>

